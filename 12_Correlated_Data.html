<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="author" content="Masanao Yajima" />

<meta name="date" content="2017-11-10" />

<meta name="progressive" content="false" />
<meta name="allow-skip" content="false" />

<title>Sources of variation</title>


<!-- highlightjs -->
<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>



</head>

<body>



<div class="pageContent band">
<div class="bandContent page">

<div class="topics">

<div id="section-introduction" class="section level2">
<h2>Introduction</h2>
<ul>
<li>So far we’ve spent quite some time trying to understand GLM. GLM has three components.
<ol style="list-style-type: decimal">
<li>Deterministic model: <span class="math inline">\(\hat{\mathbf{y}}=f(\mathbf{X})=\mathbf{X}\boldsymbol{\beta}\)</span></li>
<li>Link function
<ul>
<li>log, logit, probit, cLogLog, LogLog, Robit</li>
</ul></li>
<li>Measurement error model: <span class="math inline">\(P(\mathbf{y}|\hat{\mathbf{y}})\)</span>
<ul>
<li>Normal Linear Model – Gaussian</li>
<li>Binary Regression – Bernoulli</li>
<li>Count Regression – Binomial, Poisson,etc</li>
</ul></li>
</ol></li>
</ul>
<div id="section-bmuac-from-glm" class="section level3">
<h3>BMUAC from GLM</h3>
<ul>
<li><p>Let’s re-evaluate GLM from BMUAC framework we’ve talked about very early in the semester.</p></li>
<li>Baseline: Reference class, where is the reference?
<ul>
<li>Outcome: where <span class="math inline">\(\beta_0\)</span> is</li>
<li>Predictor: what that <span class="math inline">\(\beta_0\)</span> means as a combination of the explanatory variables</li>
</ul></li>
<li>Measurement Unit: On what scale is the difference on?
<ul>
<li>Outcome: what is <span class="math inline">\(g(\mu)\)</span>?</li>
<li>Predictor: what does unit increase of <span class="math inline">\(\mathbf{\beta}\)</span> mean</li>
</ul></li>
<li>Uncertainty: the main theme of today
<ul>
<li>Outcome: independent measurement error</li>
<li>Predictor: measurement error model ( not covered in this course )</li>
</ul></li>
<li>Assumptions: need to cover your basis
<ul>
<li>Validity: Does the question and the model match?</li>
<li>Linearity: residuals</li>
<li>Independence and constant variance of the errors: residuals</li>
</ul></li>
<li>Consequence: what is the bigger implication?
<ul>
<li>It depends.</li>
</ul></li>
<li><p>There is nothing to be argued for BMAC but what you might find restrictive is the U, so far, we’ve only looked at cases where we assumed the measurements are independent. If you think about this, this is inconvenient restriction on the cases where we can use GLMs. In this set of tutorials, we will look at how we can expand on that so that we can address bigger set of problems building on what you’ve learned so far.</p></li>
</ul>
</div>
<div id="section-example-recovery-from-stroke" class="section level3">
<h3>[Example] Recovery from stroke</h3>
<ul>
<li>An experiment to promote the recovery of stroke patients was conducted.<br />
</li>
<li>There are 3 experimental groups with 8 patients each:
<ul>
<li><em>A</em> was a new occupational therapy intervention;</li>
<li><em>B</em> was the existing stroke rehabilitation program conducted in the same hospital where A was conducted;</li>
<li><em>C</em> was the usual care regime for stroke patients provided in a different hospital.</li>
</ul></li>
<li>The response variable was a measure of functional ability, the Bartel index;
<ul>
<li>higher scores correspond to better outcomes and</li>
<li>the maximum score is 100.</li>
</ul></li>
<li>Each patient was assessed weekly over the eight weeks of the study.
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Subject"],"name":[1],"type":["int"],"align":["right"]},{"label":["Group"],"name":[2],"type":["chr"],"align":["left"]},{"label":["week1"],"name":[3],"type":["int"],"align":["right"]},{"label":["week2"],"name":[4],"type":["int"],"align":["right"]},{"label":["week3"],"name":[5],"type":["int"],"align":["right"]},{"label":["week4"],"name":[6],"type":["int"],"align":["right"]},{"label":["week5"],"name":[7],"type":["int"],"align":["right"]},{"label":["week6"],"name":[8],"type":["int"],"align":["right"]},{"label":["week7"],"name":[9],"type":["int"],"align":["right"]},{"label":["week8"],"name":[10],"type":["int"],"align":["right"]}],"data":[{"1":"1","2":"A","3":"45","4":"45","5":"45","6":"45","7":"80","8":"80","9":"80","10":"90"},{"1":"2","2":"A","3":"20","4":"25","5":"25","6":"25","7":"30","8":"35","9":"30","10":"50"},{"1":"3","2":"A","3":"50","4":"50","5":"55","6":"70","7":"70","8":"75","9":"90","10":"90"},{"1":"4","2":"A","3":"25","4":"25","5":"35","6":"40","7":"60","8":"60","9":"70","10":"80"},{"1":"5","2":"A","3":"100","4":"100","5":"100","6":"100","7":"100","8":"100","9":"100","10":"100"},{"1":"6","2":"A","3":"20","4":"20","5":"30","6":"50","7":"50","8":"60","9":"85","10":"95"},{"1":"7","2":"A","3":"30","4":"35","5":"35","6":"40","7":"50","8":"60","9":"75","10":"85"},{"1":"8","2":"A","3":"30","4":"35","5":"45","6":"50","7":"55","8":"65","9":"65","10":"70"},{"1":"9","2":"B","3":"40","4":"55","5":"60","6":"70","7":"80","8":"85","9":"90","10":"90"},{"1":"10","2":"B","3":"65","4":"65","5":"70","6":"70","7":"80","8":"80","9":"80","10":"80"},{"1":"11","2":"B","3":"30","4":"30","5":"40","6":"45","7":"65","8":"85","9":"85","10":"85"},{"1":"12","2":"B","3":"25","4":"35","5":"35","6":"35","7":"40","8":"45","9":"45","10":"45"},{"1":"13","2":"B","3":"45","4":"45","5":"80","6":"80","7":"80","8":"80","9":"80","10":"80"},{"1":"14","2":"B","3":"15","4":"15","5":"10","6":"10","7":"10","8":"20","9":"20","10":"20"},{"1":"15","2":"B","3":"35","4":"35","5":"35","6":"45","7":"45","8":"45","9":"50","10":"50"},{"1":"16","2":"B","3":"40","4":"40","5":"40","6":"55","7":"55","8":"55","9":"60","10":"65"},{"1":"17","2":"C","3":"20","4":"20","5":"30","6":"30","7":"30","8":"30","9":"30","10":"30"},{"1":"18","2":"C","3":"35","4":"35","5":"35","6":"40","7":"40","8":"40","9":"40","10":"40"},{"1":"19","2":"C","3":"35","4":"35","5":"35","6":"40","7":"40","8":"40","9":"45","10":"45"},{"1":"20","2":"C","3":"45","4":"65","5":"65","6":"65","7":"80","8":"85","9":"95","10":"100"},{"1":"21","2":"C","3":"45","4":"65","5":"70","6":"90","7":"90","8":"95","9":"95","10":"100"},{"1":"22","2":"C","3":"25","4":"30","5":"30","6":"35","7":"40","8":"40","9":"40","10":"40"},{"1":"23","2":"C","3":"25","4":"25","5":"30","6":"30","7":"30","8":"30","9":"35","10":"40"},{"1":"24","2":"C","3":"15","4":"35","5":"35","6":"35","7":"40","8":"50","9":"65","10":"65"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
</script>
</div></li>
<li><p>Below, is a plot where each patient as a line. <img src="12_Correlated_Data_files/figure-html/unnamed-chunk-3-1.png" width="90%" style="display: block; margin: auto;" /></p>
<ul>
<li>Note from visualization perspective that it is important to conned the dots to show continuity. It highlights the trend, which is not available when you look at the agregates.</li>
</ul></li>
<li>Now let’s take a moment to think about what are the
<ul>
<li>Baseline?</li>
<li>Measurement Unit?</li>
<li>Uncertainty?</li>
<li>Assumptions?</li>
<li>Comparisons?</li>
</ul></li>
<li>Was that easy for you? If not, it may be good to go back to the questions that the researchers were interested in.
<ul>
<li>Is the new treatment (A) better than the old one?</li>
</ul></li>
<li>How would you formulate this problem? Explain using figure.
<ul>
<li>Can you translate the inference into a regression parameter?</li>
<li>What are ways you can do inference?</li>
</ul></li>
</ul>
<p><img src="12_Correlated_Data_files/figure-html/unnamed-chunk-4-1.png" width="90%" style="display: block; margin: auto;" /></p>
<ul>
<li>Hints:
<ul>
<li>why are the lines wiggly? why are the patterns so messy?</li>
<li>Did all the patients start out the same?</li>
</ul></li>
</ul>
<hr />
</div>
</div>
<div id="section-stroke-recovery" class="section level2">
<h2>Stroke Recovery</h2>
<ul>
<li>An experiment to promote the recovery of stroke patients was conducted.<br />
</li>
<li>There are 3 experimental groups with 8 patients each:
<ul>
<li><em>A</em> was a new occupational therapy intervention;</li>
<li><em>B</em> was the existing stroke rehabilitation program conducted in the same hospital where A was conducted;</li>
<li><em>C</em> was the usual care regime for stroke patients provided in a different hospital.</li>
</ul></li>
<li>The response variable was a measure of functional ability, the Bartel index;
<ul>
<li>higher scores correspond to better outcomes and</li>
<li>the maximum score is 100.</li>
</ul></li>
<li>Each patient was assessed weekly over the eight weeks of the study.
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Subject"],"name":[1],"type":["int"],"align":["right"]},{"label":["Group"],"name":[2],"type":["chr"],"align":["left"]},{"label":["week1"],"name":[3],"type":["int"],"align":["right"]},{"label":["week2"],"name":[4],"type":["int"],"align":["right"]},{"label":["week3"],"name":[5],"type":["int"],"align":["right"]},{"label":["week4"],"name":[6],"type":["int"],"align":["right"]},{"label":["week5"],"name":[7],"type":["int"],"align":["right"]},{"label":["week6"],"name":[8],"type":["int"],"align":["right"]},{"label":["week7"],"name":[9],"type":["int"],"align":["right"]},{"label":["week8"],"name":[10],"type":["int"],"align":["right"]}],"data":[{"1":"1","2":"A","3":"45","4":"45","5":"45","6":"45","7":"80","8":"80","9":"80","10":"90"},{"1":"2","2":"A","3":"20","4":"25","5":"25","6":"25","7":"30","8":"35","9":"30","10":"50"},{"1":"3","2":"A","3":"50","4":"50","5":"55","6":"70","7":"70","8":"75","9":"90","10":"90"},{"1":"4","2":"A","3":"25","4":"25","5":"35","6":"40","7":"60","8":"60","9":"70","10":"80"},{"1":"5","2":"A","3":"100","4":"100","5":"100","6":"100","7":"100","8":"100","9":"100","10":"100"},{"1":"6","2":"A","3":"20","4":"20","5":"30","6":"50","7":"50","8":"60","9":"85","10":"95"},{"1":"7","2":"A","3":"30","4":"35","5":"35","6":"40","7":"50","8":"60","9":"75","10":"85"},{"1":"8","2":"A","3":"30","4":"35","5":"45","6":"50","7":"55","8":"65","9":"65","10":"70"},{"1":"9","2":"B","3":"40","4":"55","5":"60","6":"70","7":"80","8":"85","9":"90","10":"90"},{"1":"10","2":"B","3":"65","4":"65","5":"70","6":"70","7":"80","8":"80","9":"80","10":"80"},{"1":"11","2":"B","3":"30","4":"30","5":"40","6":"45","7":"65","8":"85","9":"85","10":"85"},{"1":"12","2":"B","3":"25","4":"35","5":"35","6":"35","7":"40","8":"45","9":"45","10":"45"},{"1":"13","2":"B","3":"45","4":"45","5":"80","6":"80","7":"80","8":"80","9":"80","10":"80"},{"1":"14","2":"B","3":"15","4":"15","5":"10","6":"10","7":"10","8":"20","9":"20","10":"20"},{"1":"15","2":"B","3":"35","4":"35","5":"35","6":"45","7":"45","8":"45","9":"50","10":"50"},{"1":"16","2":"B","3":"40","4":"40","5":"40","6":"55","7":"55","8":"55","9":"60","10":"65"},{"1":"17","2":"C","3":"20","4":"20","5":"30","6":"30","7":"30","8":"30","9":"30","10":"30"},{"1":"18","2":"C","3":"35","4":"35","5":"35","6":"40","7":"40","8":"40","9":"40","10":"40"},{"1":"19","2":"C","3":"35","4":"35","5":"35","6":"40","7":"40","8":"40","9":"45","10":"45"},{"1":"20","2":"C","3":"45","4":"65","5":"65","6":"65","7":"80","8":"85","9":"95","10":"100"},{"1":"21","2":"C","3":"45","4":"65","5":"70","6":"90","7":"90","8":"95","9":"95","10":"100"},{"1":"22","2":"C","3":"25","4":"30","5":"30","6":"35","7":"40","8":"40","9":"40","10":"40"},{"1":"23","2":"C","3":"25","4":"25","5":"30","6":"30","7":"30","8":"30","9":"35","10":"40"},{"1":"24","2":"C","3":"15","4":"35","5":"35","6":"35","7":"40","8":"50","9":"65","10":"65"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
</script>
</div></li>
<li>The above format is called the wide format, which is easier to see the individual units of the data. But we will work with the long format, which can be created using the melt function.</li>
</ul>
<pre class="r"><code>stroke_long &lt;- melt(stroke, id.vars = c(&quot;Subject&quot;,&quot;Group&quot;))
#setnames(stroke_long,c(&quot;variable&quot;, &quot;value&quot;),c(&quot;week&quot;,&quot;Bartel_index&quot;))
stroke_long$week_num &lt;- as.integer(stroke_long$week)

(stroke_long)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Subject"],"name":[1],"type":["int"],"align":["right"]},{"label":["Group"],"name":[2],"type":["chr"],"align":["left"]},{"label":["variable"],"name":[3],"type":["fctr"],"align":["left"]},{"label":["value"],"name":[4],"type":["int"],"align":["right"]},{"label":["week_num"],"name":[5],"type":["int"],"align":["right"]}],"data":[{"1":"1","2":"A","3":"week1","4":"45","5":"NA"},{"1":"2","2":"A","3":"week1","4":"20","5":"NA"},{"1":"3","2":"A","3":"week1","4":"50","5":"NA"},{"1":"4","2":"A","3":"week1","4":"25","5":"NA"},{"1":"5","2":"A","3":"week1","4":"100","5":"NA"},{"1":"6","2":"A","3":"week1","4":"20","5":"NA"},{"1":"7","2":"A","3":"week1","4":"30","5":"NA"},{"1":"8","2":"A","3":"week1","4":"30","5":"NA"},{"1":"9","2":"B","3":"week1","4":"40","5":"NA"},{"1":"10","2":"B","3":"week1","4":"65","5":"NA"},{"1":"11","2":"B","3":"week1","4":"30","5":"NA"},{"1":"12","2":"B","3":"week1","4":"25","5":"NA"},{"1":"13","2":"B","3":"week1","4":"45","5":"NA"},{"1":"14","2":"B","3":"week1","4":"15","5":"NA"},{"1":"15","2":"B","3":"week1","4":"35","5":"NA"},{"1":"16","2":"B","3":"week1","4":"40","5":"NA"},{"1":"17","2":"C","3":"week1","4":"20","5":"NA"},{"1":"18","2":"C","3":"week1","4":"35","5":"NA"},{"1":"19","2":"C","3":"week1","4":"35","5":"NA"},{"1":"20","2":"C","3":"week1","4":"45","5":"NA"},{"1":"21","2":"C","3":"week1","4":"45","5":"NA"},{"1":"22","2":"C","3":"week1","4":"25","5":"NA"},{"1":"23","2":"C","3":"week1","4":"25","5":"NA"},{"1":"24","2":"C","3":"week1","4":"15","5":"NA"},{"1":"1","2":"A","3":"week2","4":"45","5":"NA"},{"1":"2","2":"A","3":"week2","4":"25","5":"NA"},{"1":"3","2":"A","3":"week2","4":"50","5":"NA"},{"1":"4","2":"A","3":"week2","4":"25","5":"NA"},{"1":"5","2":"A","3":"week2","4":"100","5":"NA"},{"1":"6","2":"A","3":"week2","4":"20","5":"NA"},{"1":"7","2":"A","3":"week2","4":"35","5":"NA"},{"1":"8","2":"A","3":"week2","4":"35","5":"NA"},{"1":"9","2":"B","3":"week2","4":"55","5":"NA"},{"1":"10","2":"B","3":"week2","4":"65","5":"NA"},{"1":"11","2":"B","3":"week2","4":"30","5":"NA"},{"1":"12","2":"B","3":"week2","4":"35","5":"NA"},{"1":"13","2":"B","3":"week2","4":"45","5":"NA"},{"1":"14","2":"B","3":"week2","4":"15","5":"NA"},{"1":"15","2":"B","3":"week2","4":"35","5":"NA"},{"1":"16","2":"B","3":"week2","4":"40","5":"NA"},{"1":"17","2":"C","3":"week2","4":"20","5":"NA"},{"1":"18","2":"C","3":"week2","4":"35","5":"NA"},{"1":"19","2":"C","3":"week2","4":"35","5":"NA"},{"1":"20","2":"C","3":"week2","4":"65","5":"NA"},{"1":"21","2":"C","3":"week2","4":"65","5":"NA"},{"1":"22","2":"C","3":"week2","4":"30","5":"NA"},{"1":"23","2":"C","3":"week2","4":"25","5":"NA"},{"1":"24","2":"C","3":"week2","4":"35","5":"NA"},{"1":"1","2":"A","3":"week3","4":"45","5":"NA"},{"1":"2","2":"A","3":"week3","4":"25","5":"NA"},{"1":"3","2":"A","3":"week3","4":"55","5":"NA"},{"1":"4","2":"A","3":"week3","4":"35","5":"NA"},{"1":"5","2":"A","3":"week3","4":"100","5":"NA"},{"1":"6","2":"A","3":"week3","4":"30","5":"NA"},{"1":"7","2":"A","3":"week3","4":"35","5":"NA"},{"1":"8","2":"A","3":"week3","4":"45","5":"NA"},{"1":"9","2":"B","3":"week3","4":"60","5":"NA"},{"1":"10","2":"B","3":"week3","4":"70","5":"NA"},{"1":"11","2":"B","3":"week3","4":"40","5":"NA"},{"1":"12","2":"B","3":"week3","4":"35","5":"NA"},{"1":"13","2":"B","3":"week3","4":"80","5":"NA"},{"1":"14","2":"B","3":"week3","4":"10","5":"NA"},{"1":"15","2":"B","3":"week3","4":"35","5":"NA"},{"1":"16","2":"B","3":"week3","4":"40","5":"NA"},{"1":"17","2":"C","3":"week3","4":"30","5":"NA"},{"1":"18","2":"C","3":"week3","4":"35","5":"NA"},{"1":"19","2":"C","3":"week3","4":"35","5":"NA"},{"1":"20","2":"C","3":"week3","4":"65","5":"NA"},{"1":"21","2":"C","3":"week3","4":"70","5":"NA"},{"1":"22","2":"C","3":"week3","4":"30","5":"NA"},{"1":"23","2":"C","3":"week3","4":"30","5":"NA"},{"1":"24","2":"C","3":"week3","4":"35","5":"NA"},{"1":"1","2":"A","3":"week4","4":"45","5":"NA"},{"1":"2","2":"A","3":"week4","4":"25","5":"NA"},{"1":"3","2":"A","3":"week4","4":"70","5":"NA"},{"1":"4","2":"A","3":"week4","4":"40","5":"NA"},{"1":"5","2":"A","3":"week4","4":"100","5":"NA"},{"1":"6","2":"A","3":"week4","4":"50","5":"NA"},{"1":"7","2":"A","3":"week4","4":"40","5":"NA"},{"1":"8","2":"A","3":"week4","4":"50","5":"NA"},{"1":"9","2":"B","3":"week4","4":"70","5":"NA"},{"1":"10","2":"B","3":"week4","4":"70","5":"NA"},{"1":"11","2":"B","3":"week4","4":"45","5":"NA"},{"1":"12","2":"B","3":"week4","4":"35","5":"NA"},{"1":"13","2":"B","3":"week4","4":"80","5":"NA"},{"1":"14","2":"B","3":"week4","4":"10","5":"NA"},{"1":"15","2":"B","3":"week4","4":"45","5":"NA"},{"1":"16","2":"B","3":"week4","4":"55","5":"NA"},{"1":"17","2":"C","3":"week4","4":"30","5":"NA"},{"1":"18","2":"C","3":"week4","4":"40","5":"NA"},{"1":"19","2":"C","3":"week4","4":"40","5":"NA"},{"1":"20","2":"C","3":"week4","4":"65","5":"NA"},{"1":"21","2":"C","3":"week4","4":"90","5":"NA"},{"1":"22","2":"C","3":"week4","4":"35","5":"NA"},{"1":"23","2":"C","3":"week4","4":"30","5":"NA"},{"1":"24","2":"C","3":"week4","4":"35","5":"NA"},{"1":"1","2":"A","3":"week5","4":"80","5":"NA"},{"1":"2","2":"A","3":"week5","4":"30","5":"NA"},{"1":"3","2":"A","3":"week5","4":"70","5":"NA"},{"1":"4","2":"A","3":"week5","4":"60","5":"NA"},{"1":"5","2":"A","3":"week5","4":"100","5":"NA"},{"1":"6","2":"A","3":"week5","4":"50","5":"NA"},{"1":"7","2":"A","3":"week5","4":"50","5":"NA"},{"1":"8","2":"A","3":"week5","4":"55","5":"NA"},{"1":"9","2":"B","3":"week5","4":"80","5":"NA"},{"1":"10","2":"B","3":"week5","4":"80","5":"NA"},{"1":"11","2":"B","3":"week5","4":"65","5":"NA"},{"1":"12","2":"B","3":"week5","4":"40","5":"NA"},{"1":"13","2":"B","3":"week5","4":"80","5":"NA"},{"1":"14","2":"B","3":"week5","4":"10","5":"NA"},{"1":"15","2":"B","3":"week5","4":"45","5":"NA"},{"1":"16","2":"B","3":"week5","4":"55","5":"NA"},{"1":"17","2":"C","3":"week5","4":"30","5":"NA"},{"1":"18","2":"C","3":"week5","4":"40","5":"NA"},{"1":"19","2":"C","3":"week5","4":"40","5":"NA"},{"1":"20","2":"C","3":"week5","4":"80","5":"NA"},{"1":"21","2":"C","3":"week5","4":"90","5":"NA"},{"1":"22","2":"C","3":"week5","4":"40","5":"NA"},{"1":"23","2":"C","3":"week5","4":"30","5":"NA"},{"1":"24","2":"C","3":"week5","4":"40","5":"NA"},{"1":"1","2":"A","3":"week6","4":"80","5":"NA"},{"1":"2","2":"A","3":"week6","4":"35","5":"NA"},{"1":"3","2":"A","3":"week6","4":"75","5":"NA"},{"1":"4","2":"A","3":"week6","4":"60","5":"NA"},{"1":"5","2":"A","3":"week6","4":"100","5":"NA"},{"1":"6","2":"A","3":"week6","4":"60","5":"NA"},{"1":"7","2":"A","3":"week6","4":"60","5":"NA"},{"1":"8","2":"A","3":"week6","4":"65","5":"NA"},{"1":"9","2":"B","3":"week6","4":"85","5":"NA"},{"1":"10","2":"B","3":"week6","4":"80","5":"NA"},{"1":"11","2":"B","3":"week6","4":"85","5":"NA"},{"1":"12","2":"B","3":"week6","4":"45","5":"NA"},{"1":"13","2":"B","3":"week6","4":"80","5":"NA"},{"1":"14","2":"B","3":"week6","4":"20","5":"NA"},{"1":"15","2":"B","3":"week6","4":"45","5":"NA"},{"1":"16","2":"B","3":"week6","4":"55","5":"NA"},{"1":"17","2":"C","3":"week6","4":"30","5":"NA"},{"1":"18","2":"C","3":"week6","4":"40","5":"NA"},{"1":"19","2":"C","3":"week6","4":"40","5":"NA"},{"1":"20","2":"C","3":"week6","4":"85","5":"NA"},{"1":"21","2":"C","3":"week6","4":"95","5":"NA"},{"1":"22","2":"C","3":"week6","4":"40","5":"NA"},{"1":"23","2":"C","3":"week6","4":"30","5":"NA"},{"1":"24","2":"C","3":"week6","4":"50","5":"NA"},{"1":"1","2":"A","3":"week7","4":"80","5":"NA"},{"1":"2","2":"A","3":"week7","4":"30","5":"NA"},{"1":"3","2":"A","3":"week7","4":"90","5":"NA"},{"1":"4","2":"A","3":"week7","4":"70","5":"NA"},{"1":"5","2":"A","3":"week7","4":"100","5":"NA"},{"1":"6","2":"A","3":"week7","4":"85","5":"NA"},{"1":"7","2":"A","3":"week7","4":"75","5":"NA"},{"1":"8","2":"A","3":"week7","4":"65","5":"NA"},{"1":"9","2":"B","3":"week7","4":"90","5":"NA"},{"1":"10","2":"B","3":"week7","4":"80","5":"NA"},{"1":"11","2":"B","3":"week7","4":"85","5":"NA"},{"1":"12","2":"B","3":"week7","4":"45","5":"NA"},{"1":"13","2":"B","3":"week7","4":"80","5":"NA"},{"1":"14","2":"B","3":"week7","4":"20","5":"NA"},{"1":"15","2":"B","3":"week7","4":"50","5":"NA"},{"1":"16","2":"B","3":"week7","4":"60","5":"NA"},{"1":"17","2":"C","3":"week7","4":"30","5":"NA"},{"1":"18","2":"C","3":"week7","4":"40","5":"NA"},{"1":"19","2":"C","3":"week7","4":"45","5":"NA"},{"1":"20","2":"C","3":"week7","4":"95","5":"NA"},{"1":"21","2":"C","3":"week7","4":"95","5":"NA"},{"1":"22","2":"C","3":"week7","4":"40","5":"NA"},{"1":"23","2":"C","3":"week7","4":"35","5":"NA"},{"1":"24","2":"C","3":"week7","4":"65","5":"NA"},{"1":"1","2":"A","3":"week8","4":"90","5":"NA"},{"1":"2","2":"A","3":"week8","4":"50","5":"NA"},{"1":"3","2":"A","3":"week8","4":"90","5":"NA"},{"1":"4","2":"A","3":"week8","4":"80","5":"NA"},{"1":"5","2":"A","3":"week8","4":"100","5":"NA"},{"1":"6","2":"A","3":"week8","4":"95","5":"NA"},{"1":"7","2":"A","3":"week8","4":"85","5":"NA"},{"1":"8","2":"A","3":"week8","4":"70","5":"NA"},{"1":"9","2":"B","3":"week8","4":"90","5":"NA"},{"1":"10","2":"B","3":"week8","4":"80","5":"NA"},{"1":"11","2":"B","3":"week8","4":"85","5":"NA"},{"1":"12","2":"B","3":"week8","4":"45","5":"NA"},{"1":"13","2":"B","3":"week8","4":"80","5":"NA"},{"1":"14","2":"B","3":"week8","4":"20","5":"NA"},{"1":"15","2":"B","3":"week8","4":"50","5":"NA"},{"1":"16","2":"B","3":"week8","4":"65","5":"NA"},{"1":"17","2":"C","3":"week8","4":"30","5":"NA"},{"1":"18","2":"C","3":"week8","4":"40","5":"NA"},{"1":"19","2":"C","3":"week8","4":"45","5":"NA"},{"1":"20","2":"C","3":"week8","4":"100","5":"NA"},{"1":"21","2":"C","3":"week8","4":"100","5":"NA"},{"1":"22","2":"C","3":"week8","4":"40","5":"NA"},{"1":"23","2":"C","3":"week8","4":"40","5":"NA"},{"1":"24","2":"C","3":"week8","4":"65","5":"NA"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<ul>
<li>Below, is a plot where each patient as a line.</li>
</ul>
<pre class="r"><code>setnames(stroke_long,c(&quot;variable&quot;, &quot;value&quot;),c(&quot;week&quot;,&quot;Bartel_index&quot;))
stroke_long$week_num &lt;- as.integer(stroke_long$week)
ggplot(melt(stroke, id.vars = c(&quot;Subject&quot;,&quot;Group&quot;)))+aes(x=variable, y=value,group=Subject,color=Group)+geom_line()+facet_grid(.~Group)+ theme(axis.text.x = element_text(angle = 45, hjust = 1))+theme(legend.position=&quot;none&quot;)+xlab(&quot;&quot;)+ylab(&quot;Bartel index&quot;)</code></pre>
<p><img src="12_Correlated_Data_files/figure-html/unnamed-chunk-7-1.png" width="90%" style="display: block; margin: auto;" /></p>
<ul>
<li>Let’s look at the potential model for <span class="math inline">\(\mathbf{X}\boldsymbol{\beta}\)</span>.</li>
</ul>
<div id="section-complete-pooling-within-treatment-ignore-time" class="section level3">
<h3>Complete pooling within treatment (ignore time)</h3>
<ul>
<li>For 3 groups(j), 8 patients(i), 8 times(k) nested, the most simple thing we can do is to ignore time and just compare the averages of each group. That is, we assume the conditional means of <span class="math inline">\(y_{ijk}\)</span> to be <span class="math display">\[E(y_{ijk})=\alpha_j\]</span></li>
<li>Below I plot the mean +/- sd on top of the jittered points.</li>
</ul>
<pre class="r"><code>sumst&lt;-melt(stroke, id.vars = c(&quot;Subject&quot;,&quot;Group&quot;))%&gt;%group_by(Group)%&gt;%summarise(mean=mean(value),sd=sd(value))
ggplot(melt(stroke, id.vars = c(&quot;Subject&quot;,&quot;Group&quot;)))+aes(x=Group, y=value,color=Group)+geom_jitter(alpha=0.3)+ theme(axis.text.x = element_text(angle = 45, hjust = 1))+theme(legend.position=&quot;none&quot;)+ylab(&quot;Bartel index&quot;)+
  geom_pointrange(data=sumst,aes(x=Group,y=mean,ymin=mean-sd,ymax=mean+sd))</code></pre>
<p><img src="12_Correlated_Data_files/figure-html/unnamed-chunk-8-1.png" width="90%" style="display: block; margin: auto;" /></p>
<ul>
<li>In R this model would correspond to</li>
</ul>
<pre class="r"><code>stroke_mod0&lt;-glm( Bartel_index~Group, family=gaussian,data=stroke_long)
round(summary(stroke_mod0)$coef,2)</code></pre>
<pre><code>##             Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)    58.28       2.96   19.70     0.00
## GroupB         -5.63       4.18   -1.34     0.18
## GroupC        -12.11       4.18   -2.89     0.00</code></pre>
<ul>
<li><p>Since there is no coefficient for A, it is clear that A is taken as the baseline, and each of the coefficients for B and C correspond to the difference in the means relative to A.</p></li>
<li><p>OK, so the means of what? Means of this:</p></li>
</ul>
<pre class="r"><code>ggplot(melt(stroke, id.vars = c(&quot;Subject&quot;,&quot;Group&quot;)))+aes(x=variable, y=value,group=Subject,color=Group)+geom_line()+facet_grid(.~Group)+ theme(axis.text.x = element_text(angle = 45, hjust = 1))+theme(legend.position=&quot;none&quot;)+xlab(&quot;&quot;)+ylab(&quot;Bartel index&quot;)</code></pre>
<p><img src="12_Correlated_Data_files/figure-html/unnamed-chunk-10-1.png" width="90%" style="display: block; margin: auto;" /></p>
<ul>
<li>What you are doing is essentially looking at the middle point of all the lines in each group and comparing that. But is your standard error estimates reliable? No way. We can do this, but it’s pretty clear that that’s not the right way to go about this problem.</li>
</ul>
<hr />
</div>
<div id="section-complete-pooling-within-treatment-accounting-for-time" class="section level3">
<h3>Complete pooling within treatment (accounting for time)</h3>
<ul>
<li>For 3 groups(j), 8 patients(i), 8 times(k) nested, the next simple thing we can do is to add time. That is, we assume the conditional means of <span class="math inline">\(y_{ijk}\)</span> to be</li>
</ul>
<p><span class="math display">\[E(y_{ijk})=\alpha_j+\beta t_k\]</span></p>
<ul>
<li>In R, this would be</li>
</ul>
<pre class="r"><code>stroke_mod1&lt;-glm( Bartel_index~Group+week_num, family=gaussian,data=stroke_long)</code></pre>
<ul>
<li>Visually</li>
</ul>
<pre class="r"><code>fa&lt;-function(x){coef(stroke_mod1)[1]+coef(stroke_mod1)[4]*x}
fb&lt;-function(x){coef(stroke_mod1)[1]+coef(stroke_mod1)[2]+coef(stroke_mod1)[4]*x}
fc&lt;-function(x){coef(stroke_mod1)[1]+coef(stroke_mod1)[3]+coef(stroke_mod1)[4]*x}
ggplot(melt(stroke, id.vars = c(&quot;Subject&quot;,&quot;Group&quot;)))+aes(x=variable, y=value,color=Group)+geom_point(alpha=0.3)+ theme(axis.text.x = element_text(angle = 45, hjust = 1))+theme(legend.position=&quot;none&quot;)+ylab(&quot;Bartel index&quot;)+stat_function(fun=fa,col=&quot;red&quot;)+stat_function(fun=fb,col=&quot;green&quot;)+stat_function(fun=fc,col=&quot;blue&quot;)</code></pre>
<p><img src="12_Correlated_Data_files/figure-html/unnamed-chunk-12-1.png" width="90%" style="display: block; margin: auto;" /></p>
<ul>
<li>The estimated coefficients are</li>
</ul>
<pre class="r"><code>round(summary(stroke_mod1)$coef,2)</code></pre>
<pre><code>##             Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)    36.84       3.97    9.28     0.00
## GroupB         -5.63       3.71   -1.51     0.13
## GroupC        -12.11       3.71   -3.26     0.00
## week_num        4.76       0.66    7.20     0.00</code></pre>
<ul>
<li><p>Looking at the estimates and the figure, is this representative of the problem the researchers are interested in?</p></li>
<li><p>What this model is assuming is that the rate of the recovery is constant across the groups, and the only thing that differ is the means at week 0, which is where they start out.</p></li>
<li><p>Do you buy that?</p></li>
</ul>
<pre class="r"><code>ggplot(melt(stroke, id.vars = c(&quot;Subject&quot;,&quot;Group&quot;)))+aes(x=variable, y=value,group=Subject,color=Group)+geom_line()+facet_grid(.~Group)+ theme(axis.text.x = element_text(angle = 45, hjust = 1))+theme(legend.position=&quot;none&quot;)+xlab(&quot;&quot;)+ylab(&quot;Bartel index&quot;)</code></pre>
<p><img src="12_Correlated_Data_files/figure-html/unnamed-chunk-14-1.png" width="90%" style="display: block; margin: auto;" /></p>
<hr />
</div>
<div id="section-complete-pooling-within-treatment-and-time" class="section level3">
<h3>Complete pooling within treatment and time</h3>
<ul>
<li>For 3 groups(j), 8 patients(i), 8 times(k) nested, the more sensible thing to do seems to be to add separate time effects for each group. That is, we assume the conditional means of <span class="math inline">\(y_{ijk}\)</span> to be <span class="math display">\[E(y_{ijk})=\alpha_j +\beta_j t_k\]</span></li>
</ul>
<pre class="r"><code>dtt&lt;-melt(stroke, id.vars = c(&quot;Subject&quot;,&quot;Group&quot;))
dtt$week&lt;- as.integer(dtt$variable)
ggplot(dtt)+
  aes(x=week, y=value,color=Group)+geom_point(alpha=0.3)+stat_smooth(se=FALSE,method=&quot;lm&quot;)+ theme(axis.text.x = element_text(angle = 45, hjust = 1))+theme(legend.position=&quot;none&quot;)</code></pre>
<p><img src="12_Correlated_Data_files/figure-html/unnamed-chunk-15-1.png" width="90%" style="display: block; margin: auto;" /></p>
<pre class="r"><code>round(summary(glm( Bartel_index~Group+week_num:Group, family=gaussian,data=stroke_long))$coef,2)</code></pre>
<pre><code>##                 Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)        29.82       5.77    5.16     0.00
## GroupB              3.35       8.17    0.41     0.68
## GroupC             -0.02       8.17    0.00     1.00
## GroupA:week_num     6.32       1.14    5.53     0.00
## GroupB:week_num     4.33       1.14    3.79     0.00
## GroupC:week_num     3.64       1.14    3.18     0.00</code></pre>
<pre class="r"><code>stroke_long$group_f2&lt;- (stroke_long$Group)

round(summary(glm( Bartel_index~Group+week_num:Group-1, family=gaussian,data=stroke_long))$coef,2)</code></pre>
<pre><code>##                 Estimate Std. Error t value Pr(&gt;|t|)
## GroupA             29.82       5.77    5.16        0
## GroupB             33.17       5.77    5.74        0
## GroupC             29.80       5.77    5.16        0
## GroupA:week_num     6.32       1.14    5.53        0
## GroupB:week_num     4.33       1.14    3.79        0
## GroupC:week_num     3.64       1.14    3.18        0</code></pre>
<pre class="r"><code>ggplot(dtt)+
  aes(x=week, y=value,color=Group)+geom_point(alpha=0.3)+stat_smooth(se=FALSE,method=&quot;lm&quot;)+ theme(axis.text.x = element_text(angle = 45, hjust = 1))+theme(legend.position=&quot;none&quot;)+facet_grid(~Group)+ylab(&quot;Bartel index&quot;)</code></pre>
<p><img src="12_Correlated_Data_files/figure-html/unnamed-chunk-15-2.png" width="90%" style="display: block; margin: auto;" /></p>
<hr />
</div>
<div id="section-no-pooling" class="section level3">
<h3>No pooling</h3>
<ul>
<li>All the above models assumed a common trend across patients one way or another. Alternatively, one can fit 24 separate regression line which assumes no commonality across the patients. For 24 patients(i), 8 times(k) nested. <span class="math display">\[E(y_{ik})=\alpha_i +\beta_i t_k\]</span></li>
<li>In R this will be</li>
</ul>
<pre class="r"><code>lm( Bartel_index~week_num,data=patient_i)</code></pre>
<p><img src="12_Correlated_Data_files/figure-html/unnamed-chunk-17-1.png" width="90%" style="display: block; margin: auto;" /></p>
<ul>
<li>In this situations, rather than having one intercept and a slope for each condition, we have 24 intercepts and 24 slopes.</li>
</ul>
<pre class="r"><code>nopoolfit&lt;-stroke_long[,{lmfit=lm( Bartel_index~week_num);list(coef=coef(lmfit),se=se.coef(lmfit))}, by=Subject]</code></pre>
<pre><code>## Warning in summary.lm(object, ...): essentially perfect fit: summary may be
## unreliable</code></pre>
<pre class="r"><code>nopoolfit$Group &lt;- rep(c(&quot;A&quot;,&quot;B&quot;,&quot;C&quot;),each=16)
nopoolfit$Type &lt;- rep(c(&quot;alpha&quot;,&quot;beta&quot;),times=24)
  ggplot(nopoolfit) + geom_point() + geom_smooth(method=&quot;lm&quot;,formula=y~1,se=FALSE)+
    geom_pointrange(aes(ymax = coef + 2*se , ymin=coef - 2*se),lwd=0.2)+
    aes( y=coef, x=Subject)+geom_pointrange(aes(ymax = coef + se , ymin=coef - se))+
    geom_hline(yintercept=0,lty =2)+xlab(&quot;coefficients&quot;)+ylab(&quot;estimate +/- 2 Std.Error&quot;)+facet_grid(Type~Group,scale=&quot;free&quot;)</code></pre>
<p><img src="12_Correlated_Data_files/figure-html/unnamed-chunk-18-1.png" width="95%" style="display: block; margin: auto;" /> The blue line represent the means of the coefficients in each group. The averages of the slope coefficients tell us the group A might have higher recovery rate.</p>
<hr />
</div>
<div id="section-to-summarize" class="section level3">
<h3>To summarize</h3>
<ul>
<li>What are the strength and weakness of these studies?
<ul>
<li>Complete pooling within treatment</li>
<li>Complete pooling within treatment and time</li>
<li>No pooling</li>
</ul></li>
</ul>
<p><span class="math display">\[\begin{eqnarray*}
\mbox{(pool all)} : &amp; E(y_{ijk})=&amp;\alpha_j\\
\mbox{(pool all)} : &amp; E(y_{ijk})=&amp;\alpha_j + \beta t_k\\
\mbox{(pool treat)} : &amp;E(y_{ijk})=&amp;\alpha_j +\beta_j t_k\\
\mbox{(no pool)} :  &amp;E(y_{ik})=&amp; \alpha_i +\beta_i t_k
\end{eqnarray*}\]</span></p>
<ul>
<li>What might we be missing by proceeding with the above?</li>
</ul>
<hr />
<ul>
<li><p>Below is a scatter plot on lower triangle and correlation on the upper triangle. <img src="12_Correlated_Data_files/figure-html/unnamed-chunk-19-1.png" width="90%" style="display: block; margin: auto;" /></p></li>
<li><p>What you see is that the observations on the closer time points are correlated and the correlation tapers off as the time between the observations get larger.</p></li>
<li><p>None of the linear regression model so far was taking this aspect into account. How can we deal with such correlation?</p></li>
</ul>
<hr />
<ul>
<li>There are two ways to deal with the correlation in the cluster
<ul>
<li>Big model: focus is on covariance matrix</li>
<li>Small model: focus is on groups</li>
</ul></li>
</ul>
<hr />
</div>
</div>
<div id="section-the-big-model" class="section level2">
<h2>The big model</h2>
<ul>
<li>The big model approach to dealing with correlation is to directly model the correlation in the usual linear model framework.</li>
</ul>
<div id="section-repeated-measurement-normal-linear-model" class="section level3">
<h3>Repeated measurement normal linear model</h3>
<ul>
<li>The repeated measurement normal linear model looks identical to our usual linear regression model <span class="math display">\[\mathbf{y}=\mathbf{X}\boldsymbol{\beta}+\boldsymbol{\epsilon}\]</span> one subtle detail is that <span class="math inline">\(\mathbf{y}\)</span> is ordered so that all the observations from cluster <span class="math inline">\(1\)</span> is in at the beginning followed by observations from cluster <span class="math inline">\(2\)</span>, all the way to cluster <span class="math inline">\(N\)</span>. <span class="math display">\[\mathbf{y}=(\mathbf{y}_1,\mathbf{y}_2,\dots \mathbf{y}_N)^{T}\]</span></li>
<li><p>The big difference, however, is in the errors. Since the <span class="math inline">\(\mathbf{y}_j\)</span> are corrlated within, we will not have a diagonal matrix with identical <span class="math inline">\(\sigma^2\)</span> on all of the entries. What we have is a more general variance covariance matrix <span class="math inline">\(\mathbf{V}\)</span>, therefore <span class="math display">\[\boldsymbol{\epsilon}\sim N(\mathbf{0},\mathbf{V})\]</span> To simplify the problem we will assume correlation is only within the cluster, which translates to block diagonal covariance matrix with blocks corresponding to clusters. <span class="math display">\[\begin{eqnarray*}
\mathbf{V} =
\left[
\begin{array}{cccc}
\mathbf{V}_1 &amp; \mathbf{0} &amp; \cdots &amp; \mathbf{0}\\
\mathbf{0} &amp; \mathbf{V}_2 &amp;\cdots &amp; \mathbf{0}\\
\vdots&amp; &amp;\ddots&amp;\\
\mathbf{0} &amp; \mathbf{0} &amp; \cdots &amp; \mathbf{V}_N\\
\end{array}
\right]
\end{eqnarray*}\]</span> Within a cluster we have <span class="math display">\[\begin{eqnarray*}
\mathbf{V}_j =
\left[
\begin{array}{cccc}
\sigma^2_{j11} &amp; \sigma^2_{j12} &amp; \cdots &amp; \sigma^2_{j1n_j}\\
\sigma^2_{j21} &amp; \sigma^2_{j22} &amp;\cdots &amp; \sigma^2_{j2n_j}\\
\vdots&amp; &amp;\ddots&amp;\\
\sigma^2_{jn_j1} &amp; \sigma^2_{jn_j2} &amp; \cdots &amp; \sigma^2_{jn_in_j}\\
\end{array}
\right]
\end{eqnarray*}\]</span> and outside of the cluster we assume independence. This formulation is more general and we recover linear regression as a special case when <span class="math inline">\(\mathbf{V}=\sigma^2\mathbf{I}\)</span>.</p></li>
<li><p>Therefore, <span class="math display">\[\mathbf{y}\sim N(\mathbf{X}\boldsymbol{\beta},\mathbf{V})\]</span></p></li>
<li><p>How can we estimate such model? We will use generalized least squares, which we talked about during the bootcamp.</p></li>
</ul>
<hr />
</div>
<div id="section-generalized-least-squares" class="section level3">
<h3>Generalized least squares</h3>
<ul>
<li><p>Generalized least squares (GLS) is a way to recover the independent error model using a matrix trick so that we can use MLE like we have been for a linear regression estimation.</p></li>
<li>For a general linear regression model <span class="math display">\[ \mathbf{y}= \mathbf{X}\boldsymbol{\beta} +\boldsymbol{\epsilon}\]</span></li>
<li>Where <span class="math inline">\(Var(\boldsymbol{\epsilon})=\sigma^2\Sigma\)</span> for some known <span class="math inline">\(\Sigma\)</span>.</li>
<li>There exists lower triangular matrix <span class="math inline">\(\mathbf{L}\)</span> such that <span class="math inline">\(\Sigma=\mathbf{L}\mathbf{L}^{T}\)</span>.</li>
<li>Multiplying <span class="math inline">\(\mathbf{L}^{-1}\)</span> on both sides we get <span class="math display">\[\begin{eqnarray}
\mathbf{L}^{-1}\mathbf{y}&amp;=&amp; \mathbf{L}^{-1}\mathbf{X}\boldsymbol{\beta} +\mathbf{L}^{-1}\boldsymbol{\epsilon}\\
\mathbf{y}^{\star}&amp;=&amp; \mathbf{X}^{\star}\boldsymbol{\beta} +\boldsymbol{\epsilon}^{\star}
\end{eqnarray}\]</span></li>
<li>Now <span class="math inline">\(Var(\boldsymbol{\epsilon}^{\star})=\sigma^2\mathbf{I}\)</span>.</li>
<li><p>Therefore we can use ordinary least squares using <span class="math inline">\(\mathbf{y}^{\star}\)</span> and <span class="math inline">\(\mathbf{X}^{\star}\)</span>, which gives us <span class="math display">\[\mathbf{\hat{\beta}}=(\mathbf{X}^{T}\Sigma^{-1}\mathbf{X})^{-1}\mathbf{X}^{T}\Sigma^{-1}\mathbf{y}\]</span> and <span class="math display">\[Var(\mathbf{\hat{\beta}})=\sigma^2(\mathbf{X}^{T}\Sigma^{-1}\mathbf{X})^{-1}\]</span></p></li>
</ul>
<hr />
</div>
<div id="section-gls-for-repeated-measurement-normal-linear-model" class="section level3">
<h3>GLS for repeated measurement normal linear model</h3>
<ul>
<li>For <span class="math display">\[\mathbf{y}\sim N(\mu=\mathbf{X}\boldsymbol{\beta},\mathbf{V})\]</span></li>
<li>For known <span class="math inline">\(\mathbf{V}\)</span> we use GLS which give us <span class="math display">\[\tilde{\boldsymbol{\beta}}=(\mathbf{X}^{T}\mathbf{V}^{-1}\mathbf{X})^{-1}\mathbf{X}^{T}\mathbf{V}^{-1}\mathbf{y}=(\sum_j^J\mathbf{X}_j^{T}\mathbf{V}_j^{-1}\mathbf{X}_j)^{-1}(\sum_j^J\mathbf{X}_j^{T}\mathbf{V}_j^{-1}\mathbf{y}_j)\]</span></li>
<li>and <span class="math display">\[Var(\tilde{\boldsymbol{\beta}})=(\mathbf{X}^{T}\mathbf{V}^{-1}\mathbf{X})^{-1}=(\sum_j^J\mathbf{X}_j^{T}\mathbf{V}_j^{-1}\mathbf{X}_j)^{-1}\]</span></li>
<li>But in reality, we never know <span class="math inline">\(\mathbf{V}\)</span> so we need to estimate it. The algorithm we will use is an interatively reweighted least squares.
<ol style="list-style-type: decimal">
<li>Estimate <span class="math inline">\(\hat{\boldsymbol{\beta}}\)</span> and get <span class="math display">\[\hat{\boldsymbol{\mu}}=\mathbf{X}\hat{\boldsymbol{\beta}}\]</span></li>
<li>Calculate the residuals <span class="math display">\[\mathbf{r}=\mathbf{y}-\hat{\boldsymbol{\mu}}\]</span></li>
<li>Use variance covariance of <span class="math inline">\(\mathbf{r}\)</span> to estimate <span class="math display">\[\hat{\mathbf{V}}=\frac{1}{n-1}\mathbf{r}\mathbf{r}^{T}\]</span></li>
<li>Repeat until convergence.</li>
</ol></li>
</ul>
<hr />
</div>
<div id="section-infromation-sandwich-estimator-huber-estimator" class="section level3">
<h3>(Infromation) Sandwich estimator (Huber estimator)</h3>
<ul>
<li>Unfortunately, the estimated covariance matrix <span class="math inline">\(\hat{\mathbf{V}}\)</span> is known to under-estimate the variability. The preferred alternative is the Sandwich estimator or the Huber estimator.</li>
<li>It is consistent estimator of <span class="math inline">\(Var(\tilde{\boldsymbol{\beta}})\)</span> when <span class="math inline">\(\mathbf{V}\)</span> is unknown and it is robust to misspecification of <span class="math inline">\(\mathbf{V}\)</span>. <span class="math display">\[Var(\tilde{\boldsymbol{\beta}})=\boldsymbol{\mathcal{I}}^{-1}\mathbf{C}\boldsymbol{\mathcal{I}}^{-1}\]</span> where <span class="math inline">\(\boldsymbol{\mathcal{I}}\)</span> is the information matrix defined as <span class="math display">\[\boldsymbol{\mathcal{I}}=(\mathbf{X}^{T}\mathbf{\hat{V}}^{-1}\mathbf{X}) \]</span> and <span class="math display">\[\mathbf{C}=\sum^N_i \mathbf{X}^{T}_i\mathbf{\hat{V}}^{-1}_i(\mathbf{y}_i-\mathbf{X}\boldsymbol{\hat{\beta}})(\mathbf{y}_i-\mathbf{X}\boldsymbol{\hat{\beta}})\mathbf{\hat{V}}^{-1}_i\mathbf{X}_i\]</span></li>
</ul>
<hr />
</div>
<div id="section-parametrization-of-covariance-matrix" class="section level3">
<h3>Parametrization of covariance matrix</h3>
<ul>
<li>Since there are many parameters in the variance covariance matrix and often we don’t have the luxury to estimate all of the parameters, in most cases people would make simplifying assumptions to reduce the number of parameters that needs to be estimated.</li>
<li>There are many different forms of the variance covariance matrix that one could specify depending on the problem. Here are handful of examples that are popular.</li>
</ul>
<ol style="list-style-type: decimal">
<li>Equicorrelation/exchangeable covariance matrix assumes all of the observations within a cluster have same covariance. Therefore it assumes no particular structure of associations. <span class="math display">\[\begin{eqnarray*}
\mathbf{V}_j =
\sigma^2\left[
\begin{array}{cccc}
1 &amp; \rho &amp; \cdots &amp;\rho\\
\rho &amp; 1 &amp;\cdots &amp;\rho\\
\vdots&amp;&amp;\ddots&amp;\\
\rho &amp; \rho &amp; \cdots &amp; 1\\
\end{array}
\right]
\end{eqnarray*}\]</span> where <span class="math inline">\(\rho\)</span> intra-class correlation coefficient <!-- - when $\rho=\sigma^2_a/(\sigma^2_a+\sigma^2_b)$ --></li>
</ol>
<hr />
<ol start="2" style="list-style-type: decimal">
<li>Autoregressive model (AR): AR models are used when the correlation is defined as some function of distance between the measurements. In terms of time series, you expect the closer observations to have more correlation than observations far apart. <span class="math display">\[\begin{eqnarray*}
\mathbf{V}_j =
\sigma^2\left[
\begin{array}{ccccc}
1 &amp; \rho &amp;\rho^2 &amp; \cdots &amp;\rho^{n-1}\\
\rho &amp; 1 &amp;\rho &amp;\cdots &amp; \rho^{n-2}\\
\rho^2 &amp; \rho &amp; 1 &amp;\cdots &amp; \rho\\
\vdots&amp;&amp;\ddots&amp;&amp;\\
\rho^{n-1} &amp; \rho &amp; \cdots &amp; \rho &amp; 1\\
\end{array}
\right]
\end{eqnarray*}\]</span></li>
</ol>
<hr />
<ol start="3" style="list-style-type: decimal">
<li>Unstructured: Unstructured covariance matrix is assumes no particular structure of the association but allows for any kind of association. <span class="math display">\[\begin{eqnarray*}
\mathbf{V}_j =
\sigma^2\left[
\begin{array}{cccc}
1 &amp; \rho_{12} &amp; \cdots &amp;\rho_{1n}\\
\rho_{21} &amp; 1 &amp;\cdots &amp;\rho_{2n}\\
\vdots&amp;&amp;\ddots&amp;\\
\rho_{n1} &amp; \rho_{n2} &amp; \cdots &amp; 1\\
\end{array}
\right]
\end{eqnarray*}\]</span></li>
</ol>
<hr />
</div>
<div id="section-generalized-estimating-equations-gees" class="section level3">
<h3>Generalized estimating equations (GEEs)</h3>
<ul>
<li>For GLM, we have something called the generalized estimating equations (GEE), which is essentially the same procedure we’ve described for the linear model for none normal error model. <span class="math inline">\(E(\mathbf{y}_j)= \boldsymbol{\mu}_j\)</span> and <span class="math inline">\(g(\boldsymbol{\mu}_j) = \mathbf{X}_j\beta=\boldsymbol{\eta}_j\)</span>. <!-- - Likelihood equations for a GLM --> <!-- $$\frac{\partial L(\beta)}{\partial \beta_k}=\sum_{j=1}^{n}\frac{(y_j-\mu_j)x_{ij}}{Var(y_j)}\frac{\partial \mu_j}{\partial \eta_j}=\sum_{j=1}^{n}\frac{(y_j-\mu_j)}{Var(y_j)}\frac{\partial \mu_j}{\partial \beta_j}=0 --> <!-- $$ --></li>
<li><p>GEE or quasi-score equations is defined as <span class="math display">\[\mathbf{U}=\sum^J_j \mathbf{D}^{T}_j\mathbf{V}^{-1}_j(\mathbf{y}_j-\boldsymbol{\mu}_j)=\mathbf{0}\]</span> where <span class="math inline">\(\mathbf{D}_j\)</span> is matrix of <span class="math inline">\(\frac{\partial \mathbf{\mu}_j}{\partial \beta_k}\)</span>.</p></li>
<li>The variance <span class="math inline">\(\mathbf{V}_j=\mathbf{A}_j \mathbf{R}_j \mathbf{A}_j\psi\)</span> where <span class="math inline">\(\mathbf{A}_j\)</span> is diagonal matrix with <span class="math inline">\(\sqrt{Var(y_{ij})}\)</span></li>
<li><span class="math inline">\(\mathbf{R}_j\)</span> is the correlation matrix <span class="math inline">\(\mathbf{y}_j\)</span></li>
<li><p><span class="math inline">\(\psi\)</span> is the overdispersion parameter</p></li>
</ul>
<hr />
</div>
<div id="section-sandwich-estimator-for-gee" class="section level3">
<h3>Sandwich estimator for GEE</h3>
<ul>
<li>It is more important for GEE to use the sandwich estimator.</li>
<li>This is given as <span class="math display">\[Var(\tilde{\boldsymbol{\beta}})=\boldsymbol{\mathcal{I}}^{-1}\mathbf{C}\boldsymbol{\mathcal{I}}^{-1}\]</span></li>
<li>where the information matrix is <span class="math display">\[\boldsymbol{\mathcal{I}}=(\mathbf{D}^{T}\mathbf{\hat{V}}^{-1}\mathbf{D})\]</span></li>
<li><p>and <span class="math display">\[\mathbf{C}=\sum^N_i \mathbf{D}^{T}_i\mathbf{\hat{V}}^{-1}_i(\mathbf{y}_i-\mathbf{D}\boldsymbol{\hat{\beta}})(\mathbf{y}_i-\mathbf{D}\boldsymbol{\hat{\beta}})\mathbf{\hat{V}}^{-1}_i\mathbf{D}_i\]</span></p></li>
<li><p>Asymptotically <span class="math inline">\(\boldsymbol{\hat{\beta}}\sim N(\boldsymbol{\beta},Var(\tilde{\boldsymbol{\beta}}))\)</span></p></li>
</ul>
<hr />
</div>
<div id="section-fitting-gee-in-r" class="section level3">
<h3>Fitting GEE in R</h3>
<pre class="r"><code>glm_fit &lt;-glm( Bartel_index~Group*week_num, 
               family=gaussian,data=stroke_long)
lme_fit &lt;-lmer( Bartel_index~Group*week_num+(1|Subject),
                data=stroke_long)

stroke_long&lt;-stroke_long[order(Subject,week_num),]
library(geepack)
glm_ind&lt;-geeglm( Bartel_index~Group*week_num, id=Subject,waves=week_num,
                 family=gaussian,data=stroke_long, corstr=&quot;independence&quot;)
glm_exc&lt;-geeglm( Bartel_index~Group*week_num, id=Subject,waves=week_num,
                 family=gaussian,data=stroke_long, corstr=&quot;exchangeable&quot;)
glm_ar1&lt;-geeglm( Bartel_index~Group*week_num, id=Subject,waves=week_num,
                 family=gaussian,data=stroke_long, corstr=&quot;ar1&quot;)
glm_uns&lt;-geeglm( Bartel_index~Group*week_num, id=Subject,waves=week_num,
                 family=gaussian,data=stroke_long, corstr=&quot;unstructured&quot;)
#library(gee)
#round(summary(gee( Bartel_index~Group*week_num, family=gaussian,
#                   data=stroke_long,id=week, corstr=&quot;AR-M&quot;, Mv=1))$coef[,2],2)</code></pre>
<hr />
<pre class="r"><code>library(gee)
gee_ind&lt;-gee( Bartel_index~Group*week_num, id=Subject,
              family=gaussian,data=stroke_long, corstr=&quot;independence&quot;)</code></pre>
<pre><code>##     (Intercept)          GroupB          GroupC        week_num 
##     29.82142857      3.34821429     -0.02232143      6.32440476 
## GroupB:week_num GroupC:week_num 
##     -1.99404762     -2.68601190</code></pre>
<pre class="r"><code>gee_exc&lt;-gee( Bartel_index~Group*week_num, id=Subject,
              family=gaussian,data=stroke_long, corstr=&quot;exchangeable&quot;)</code></pre>
<pre><code>##     (Intercept)          GroupB          GroupC        week_num 
##     29.82142857      3.34821429     -0.02232143      6.32440476 
## GroupB:week_num GroupC:week_num 
##     -1.99404762     -2.68601190</code></pre>
<pre class="r"><code>gee_ar1&lt;-gee( Bartel_index~Group*week_num, id=Subject,
              family=gaussian,data=stroke_long, corstr=&quot;AR-M&quot;,Mv=1)</code></pre>
<pre><code>##     (Intercept)          GroupB          GroupC        week_num 
##     29.82142857      3.34821429     -0.02232143      6.32440476 
## GroupB:week_num GroupC:week_num 
##     -1.99404762     -2.68601190</code></pre>
<pre class="r"><code>gee_uns&lt;-gee( Bartel_index~Group*week_num, id=Subject,
              family=gaussian,data=stroke_long, corstr=&quot;unstructured&quot;)</code></pre>
<pre><code>##     (Intercept)          GroupB          GroupC        week_num 
##     29.82142857      3.34821429     -0.02232143      6.32440476 
## GroupB:week_num GroupC:week_num 
##     -1.99404762     -2.68601190</code></pre>
<pre><code>## Warning in gee(Bartel_index ~ Group * week_num, id = Subject, family =
## gaussian, : Maximum number of iterations consumed</code></pre>
<pre><code>## Warning in gee(Bartel_index ~ Group * week_num, id = Subject, family =
## gaussian, : Convergence not achieved; results suspect</code></pre>
<pre><code>## Warning in gee(Bartel_index ~ Group * week_num, id = Subject, family =
## gaussian, : Cgee had an error (code= 104). Results suspect.</code></pre>
<pre><code>## Warning in gee(Bartel_index ~ Group * week_num, id = Subject, family =
## gaussian, : Working correlation estimate not positive definite</code></pre>
<pre class="r"><code>require(lsmeans)
pondtemp.posthoc &lt;- lsmeans(glm_ar1, pairwise~Group*week_num, adjust = &quot;tukey&quot;)
pondtemp.posthoc &lt;- lsmeans(glm_ar1, pairwise~Group*week_num, adjust = &quot;none&quot;)
pondtemp.sum     &lt;- summary(pondtemp.posthoc)
pondtemp.contrast &lt;- data.frame(pondtemp.sum$contrasts)</code></pre>
<hr />
<ul>
<li>Coefficients</li>
</ul>
<pre><code>##         [,1] [,2]  [,3] [,4]  [,5]  [,6]
## glm    29.82 3.35 -0.02 6.32 -1.99 -2.69
## geeglm 29.82 3.35 -0.02 6.32 -1.99 -2.69
## geeglm 29.82 3.35 -0.02 6.32 -1.99 -2.69
## geeglm 33.24 0.12 -5.96 6.08 -2.14 -2.24
## geeglm 27.54 0.92  1.55 6.88 -1.42 -3.07
## lmer   29.82 3.35 -0.02 6.32 -1.99 -2.69</code></pre>
<ul>
<li>SE</li>
</ul>
<pre><code>##           [,1]    [,2]    [,3]   [,4]   [,5]   [,6]
## glm       5.77    8.17    8.17   1.14   1.62   1.62
## geeglm   10.18   11.63   10.90   1.13   1.48   1.47
## geeglm   10.18   11.63   10.90   1.13   1.48   1.47
## geeglm    9.76   10.96   10.38   1.04   1.33   1.47
## geeglm 1727.07 2222.04 2010.53 469.58 603.77 546.70
## lmer      7.50   10.60   10.60   0.47   0.66   0.66</code></pre>
<pre class="r"><code>library(lme4)
lmer_01 &lt;- lmer( Bartel_index~Group*week_num+(1+week_num|Subject),data=stroke_long)
simlmer_01 &lt;- sim(lmer_01)
par(mfrow=c(1,3))
with(stroke_long[stroke_long$Group==&quot;A&quot;,],
plot(week_num,Bartel_index,col=factor(Group))
)
for(i in 1:8) abline(fixef(lmer_01)[1]+ranef(lmer_01)$Subject[i,1],fixef(lmer_01)[4]+ranef(lmer_01)$Subject[i,2])
with(stroke_long[stroke_long$Group==&quot;B&quot;,],
plot(week_num,Bartel_index,col=factor(Group))
)
for(i in 9:16) abline(fixef(lmer_01)[1]+fixef(lmer_01)[2]+ranef(lmer_01)$Subject[i,1],fixef(lmer_01)[4]+fixef(lmer_01)[5]+ranef(lmer_01)$Subject[i,2])
with(stroke_long[stroke_long$Group==&quot;C&quot;,],
plot(week_num,Bartel_index,col=factor(Group))
)
for(i in 17:24) abline(fixef(lmer_01)[1]+fixef(lmer_01)[3]+ranef(lmer_01)$Subject[i,1],fixef(lmer_01)[4]+fixef(lmer_01)[6]+ranef(lmer_01)$Subject[i,2])</code></pre>
<p><img src="12_Correlated_Data_files/figure-html/unnamed-chunk-26-1.png" width="95%" style="display: block; margin: auto;" /></p>
<pre class="r"><code>library(nlme)
lme_01 &lt;- lme( Bartel_index~Group*week_num,random= ~ 1|Subject,correlation = corAR1(),
               data=stroke_long)
simlmer_01 &lt;- sim(lmer_01)</code></pre>
<hr />
</div>
</div>
<div id="section-the-small-model" class="section level2">
<h2>The small model</h2>
<!-- ### No pooling -->
<!-- - 24 patients(i), 8 times(k) nested. -->
<!-- $$E(y_{ik})=\alpha_i +\beta_i t_k $$ -->
<!-- ```{r,echo=FALSE, fig.width=7,fig.height=3 ,out.width="90%",warning=FALSE,message=FALSE} -->
<!-- ggplot(stroke_long)+aes(x=week_num, y=Bartel_index,color=factor(Subject))+geom_smooth(method="lm",se=FALSE)+geom_jitter(alpha=0.3)+ theme(axis.text.x = element_text(angle = 45, hjust = 1))+theme(legend.position="none")+ylab("Bartel index")+facet_grid(.~Group)+geom_smooth(method="lm",se=FALSE,aes(group=1),lty=2) -->
<!-- # round(summary(glm( Bartel_index~Group+week_num, family=gaussian,data=stroke_long))$coef,2) -->
<!-- nopoolfit<-stroke_long[,{lmfit=lm( Bartel_index~week_num);list(coef=coef(lmfit),se=se.coef(lmfit))}, by=Subject] -->
<!-- nopoolfit$Group <- rep(c("A","B","C"),each=16) -->
<!-- nopoolfit$Type <- rep(c("alpha","beta"),times=24) -->
<!--   ggplot(nopoolfit) + geom_point() + geom_smooth(method="lm",formula=y~1,se=FALSE)+ -->
<!--     geom_pointrange(aes(ymax = coef + 2*se , ymin=coef - 2*se),lwd=0.2)+ -->
<!--     aes( y=coef, x=Subject)+geom_pointrange(aes(ymax = coef + se , ymin=coef - se))+ -->
<!--     geom_hline(yintercept=0,lty    =2)+xlab("coefficients")+ylab("estimate +/- 2 Std.Error")+facet_grid(Type~Group,scale="free") -->
<!-- ``` -->
<hr />
<div id="section-glmm-multilevel-model-hierarchical-model" class="section level3">
<h3>GLMM / Multilevel model / hierarchical model/</h3>
<ul>
<li>The usual model for <span class="math inline">\(i =1,2,\cdots, n\)</span> <span class="math display">\[y_i=\mu + \alpha_j[i]+e_i\]</span> where</li>
<li><span class="math inline">\(e_i\sim N(0,\sigma_y^2)\)</span></li>
<li><p><span class="math inline">\(\alpha_j\sim N(\mu_{\alpha},\sigma_{\alpha}^2)\)</span></p></li>
<li><span class="math inline">\(E(y_i)=\mu\)</span></li>
<li>if ith subject is from j cluster <span class="math inline">\(Var(y_i)=E[(y_i-\mu)^2]=E[( \alpha_j+e_i)^2]=\sigma_{\alpha}^2+\sigma_y^2\)</span></li>
<li>if sth subject and rth subject are from same cluster <span class="math inline">\(Cov(y_s, y_r)=E[( \alpha_j+e_s)( \alpha_j+e_r)=\sigma_{\alpha}^2\)</span></li>
<li><p>if sth subject and rth subject are from different cluster <span class="math inline">\(Cov(y_s, y_r)=E[( \alpha_j+e_s)( \alpha_k+e_r)=0\)</span></p></li>
</ul>
<p><span class="math display">\[\begin{eqnarray*}
\mathbf{V}_j =
\left[
\begin{array}{cccc}
\sigma^2_{\alpha}+ \sigma^2_{y} &amp; \sigma^2_{\alpha} &amp; \cdots &amp;\sigma^2_{\alpha}\\
\sigma^2_{\alpha} &amp; \sigma^2_{\alpha}+ \sigma^2_{y}  &amp;\cdots &amp;\sigma^2_{\alpha}\\
\vdots&amp;&amp;\ddots&amp;\\
\sigma^2_{\alpha} &amp; \sigma^2_{\alpha} &amp; \cdots &amp; \sigma^2_{\alpha}+ \sigma^2_{y} \\
\end{array}
\right]=
\sigma^2_{\alpha}+\sigma^2_{y}
\left[
\begin{array}{cccc}
1 &amp; \rho &amp; \cdots &amp;\rho\\
\rho &amp; 1 &amp;\cdots &amp;\rho\\
\vdots&amp;&amp;\ddots&amp;\\
\rho &amp; \rho &amp; \cdots &amp; 1\\
\end{array}
\right]
\end{eqnarray*}\]</span></p>
<hr />
<ul>
<li>in R</li>
</ul>
<pre class="r"><code>lmer(y~x+(1|group))</code></pre>
<hr />
<ul>
<li><p>Partial pooling (shrinkage) of group coefficients</p></li>
<li>Multilevel modeling partially pools the group-level parameters <span class="math inline">\(\alpha_j\)</span> toward their mean level, <span class="math inline">\(\mu_{\alpha}\)</span>.</li>
<li><p>There is more pooling when the group-level standard deviation <span class="math inline">\(\sigma_{\alpha}^2\)</span> is small, and more smoothing for groups with fewer observations. <span class="math display">\[\begin{eqnarray*}
\alpha_j &amp;\approx &amp;\frac{\frac{n_j}{\sigma_y^2}}{\frac{n_j}{\sigma_y^2}+
\frac{1}{\sigma_{\alpha}^2}}(\bar{y}_j-\hat{\mu}_j)+\frac{\frac{1}{\sigma_{\alpha}^2}}{\frac{n_j}{\sigma_y^2}+
\frac{1}{\sigma_{\alpha}^2}}(\mu_{\alpha})\\
\alpha_j &amp;\approx &amp;\frac{\frac{n_j}{\sigma_y^2}}{\frac{n_j}{\sigma_y^2}+
\frac{1}{\sigma_{\alpha}^2}}(\mbox{estimate from group j})+\frac{\frac{1}{\sigma_{\alpha}^2}}{\frac{n_j}{\sigma_y^2}+
\frac{1}{\sigma_{\alpha}^2}}(\mbox{estimate from regression})
\end{eqnarray*}\]</span></p></li>
</ul>

<script type="application/shiny-prerendered" data-context="server-start">
knitr::opts_chunk$set(echo = TRUE, fig.width=5.656,fig.height=4,fig.align="center",
                      out.width="95%",dev="CairoPNG")
knitr::knit_hooks$set(mysize = function(before, options, envir) {
  if (before) 
    return(options$size)
})
</script>
 <!--html_preserve-->
<script type="application/shiny-prerendered" data-context="dependencies">
{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["jquery"]},{"type":"character","attributes":{},"value":["1.11.3"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/jquery"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquery.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.15"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["bootstrap"]},{"type":"character","attributes":{},"value":["3.3.5"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/bootstrap"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["viewport"]}},"value":[{"type":"character","attributes":{},"value":["width=device-width, initial-scale=1"]}]},{"type":"character","attributes":{},"value":["js/bootstrap.min.js","shim/html5shiv.min.js","shim/respond.min.js"]},{"type":"character","attributes":{},"value":["css/cerulean.min.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.15"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["pagedtable"]},{"type":"character","attributes":{},"value":["1.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/pagedtable-1.1"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/pagedtable.js"]},{"type":"character","attributes":{},"value":["css/pagedtable.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.15"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["highlightjs"]},{"type":"character","attributes":{},"value":["9.12.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/highlightjs"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["highlight.js"]},{"type":"character","attributes":{},"value":["textmate.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.15"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["tutorial"]},{"type":"character","attributes":{},"value":["0.9.2.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/tutorial"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tutorial.js"]},{"type":"character","attributes":{},"value":["tutorial.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.9.2.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["tutorial-autocompletion"]},{"type":"character","attributes":{},"value":["0.9.2.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/tutorial"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tutorial-autocompletion.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.9.2.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["tutorial-diagnostics"]},{"type":"character","attributes":{},"value":["0.9.2.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/tutorial"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tutorial-diagnostics.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.9.2.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["tutorial-format"]},{"type":"character","attributes":{},"value":["0.9.2.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmarkdown/templates/tutorial/resources"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tutorial-format.js"]},{"type":"character","attributes":{},"value":["tutorial-format.css","rstudio-theme.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.9.2.1"]}]}]}
</script>
<!--/html_preserve-->
<!--html_preserve-->
<script type="application/shiny-prerendered" data-context="execution_dependencies">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["packages"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["packages","version"]},"class":{"type":"character","attributes":{},"value":["data.frame"]},"row.names":{"type":"integer","attributes":{},"value":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96]}},"value":[{"type":"character","attributes":{},"value":["abind","arm","assertthat","backports","base","boot","Cairo","car","carData","cellranger","coda","colorspace","compiler","crayon","curl","data.table","datasets","digest","dplyr","ellipse","emmeans","estimability","evaluate","forcats","foreign","gee","geepack","ggplot2","glue","graphics","grDevices","grid","gridExtra","gtable","haven","hms","htmltools","htmlwidgets","httpuv","jsonlite","knitr","labeling","later","lattice","lazyeval","learnr","lme4","lmtest","lsmeans","magrittr","markdown","MASS","Matrix","methods","mime","minqa","munsell","mvtnorm","nlme","nloptr","openxlsx","pacman","pillar","pkgconfig","plyr","promises","purrr","R6","RColorBrewer","Rcpp","readxl","reshape2","rio","rlang","rmarkdown","rprojroot","scales","shiny","splines","stats","stats4","stringi","stringr","tibble","tidyselect","tools","utils","vctrs","VGAM","withr","xfun","xtable","yaml","zeallot","zip","zoo"]},{"type":"character","attributes":{},"value":["1.4-5","1.10-1","0.2.1","1.1.4","3.6.1","1.3-22","1.5-10","3.0-3","3.0-2","1.1.0","0.19-3","1.4-1","3.6.1","1.3.4","4.2","1.12.2","3.6.1","0.6.21","0.8.3","0.4.1","1.4.2","1.3","0.14","0.4.0","0.8-71","4.13-19","1.2-1","3.2.1","1.3.1","3.6.1","3.6.1","3.6.1","2.3","0.3.0","2.1.1","0.5.1","0.3.6","1.5.1","1.5.2","1.6","1.25","0.3","0.8.0","0.20-38","0.2.2","0.9.2.1","1.1-21","0.9-37","2.30-0","1.5","1.1","7.3-51.4","1.2-17","3.6.1","0.7","1.2.4","0.5.0","1.0-11","3.1-140","1.2.1","4.1.0.1","0.5.1","1.4.2","2.0.3","1.8.4","1.0.1","0.3.2","2.4.0","1.1-2","1.0.2","1.3.1","1.4.3","0.5.16","0.4.0","1.15","1.3-2","1.0.0","1.3.2","3.6.1","3.6.1","3.6.1","1.4.3","1.4.0","2.1.3","0.2.5","3.6.1","3.6.1","0.2.0","1.1-1","2.1.2","0.9","1.8-4","2.2.0","0.1.0","2.0.4","1.8-6"]}]}]}
</script>
<!--/html_preserve-->
</div>
</div>

</div> <!-- topics -->

<div class="topicsContainer">
<div class="topicsPositioner">
<div class="band">
<div class="bandContent topicsListContainer">

<!-- begin doc-metadata -->
<div id="doc-metadata">
<h2 class="title toc-ignore" style="display:none;">Sources of variation</h2>
<h4 class="author"><em>Masanao Yajima</em></h4>
<h4 class="date"><em>November 10, 2017</em></h4>
</div>
<!-- end doc-metadata -->

</div> <!-- bandContent.topicsListContainer -->
</div> <!-- band -->
</div> <!-- topicsPositioner -->
</div> <!-- topicsContainer -->


</div> <!-- bandContent page -->
</div> <!-- pageContent band -->




<script>
// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});
</script>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>

</html>
